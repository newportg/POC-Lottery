#pragma checksum "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "e80c7908409acc8496a3d7026441e2af096f6d4a"
// <auto-generated/>
#pragma warning disable 1591
namespace Lottery.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using Lottery;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\_Imports.razor"
using Lottery.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
using Lottery.Data;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Components.RouteAttribute("/drawselection")]
    public partial class DrawSelection : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<h1>ThunderBall Draw Selection</h1>\r\n\r\n");
#nullable restore
#line 8 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
 if (items == null)
{

#line default
#line hidden
#nullable disable
            __builder.AddContent(1, "    ");
            __builder.AddMarkupContent(2, "<p><em>Loading...</em></p>\r\n");
#nullable restore
#line 11 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
}
else
{

#line default
#line hidden
#nullable disable
            __builder.AddContent(3, "    ");
            __builder.OpenElement(4, "table");
            __builder.AddAttribute(5, "class", "table table-bordered table-hover");
            __builder.AddMarkupContent(6, "\r\n        ");
            __builder.OpenElement(7, "thead");
            __builder.AddMarkupContent(8, "\r\n            ");
            __builder.OpenElement(9, "tr");
            __builder.AddMarkupContent(10, "\r\n                ");
            __builder.OpenElement(11, "th");
            __builder.AddMarkupContent(12, "\r\n                    ");
            __builder.OpenElement(13, "span");
            __builder.AddAttribute(14, "class", "sort-link");
            __builder.AddAttribute(15, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 18 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                                        ()=>SortTable("Ball1")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(16, "Ball1");
            __builder.CloseElement();
            __builder.AddMarkupContent(17, "\r\n                    ");
            __builder.OpenElement(18, "span");
            __builder.AddAttribute(19, "class", "fa" + " " + (
#nullable restore
#line 19 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                      GetSortStyle("Ball1")

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseElement();
            __builder.AddMarkupContent(20, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(21, "\r\n                ");
            __builder.OpenElement(22, "th");
            __builder.AddMarkupContent(23, "\r\n                    ");
            __builder.OpenElement(24, "span");
            __builder.AddAttribute(25, "class", "sort-link");
            __builder.AddAttribute(26, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 22 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                                        ()=>SortTable("Ball2")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(27, "Ball2");
            __builder.CloseElement();
            __builder.AddMarkupContent(28, "\r\n                    ");
            __builder.OpenElement(29, "span");
            __builder.AddAttribute(30, "class", "fa" + " " + (
#nullable restore
#line 23 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                      GetSortStyle("Ball2")

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseElement();
            __builder.AddMarkupContent(31, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(32, "\r\n                ");
            __builder.OpenElement(33, "th");
            __builder.AddMarkupContent(34, "\r\n                    ");
            __builder.OpenElement(35, "span");
            __builder.AddAttribute(36, "class", "sort-link");
            __builder.AddAttribute(37, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 26 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                                        ()=>SortTable("Ball3")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(38, "Ball3");
            __builder.CloseElement();
            __builder.AddMarkupContent(39, "\r\n                    ");
            __builder.OpenElement(40, "span");
            __builder.AddAttribute(41, "class", "fa" + " " + (
#nullable restore
#line 27 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                      GetSortStyle("Ball3")

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseElement();
            __builder.AddMarkupContent(42, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(43, "\r\n                ");
            __builder.OpenElement(44, "th");
            __builder.AddMarkupContent(45, "\r\n                    ");
            __builder.OpenElement(46, "span");
            __builder.AddAttribute(47, "class", "sort-link");
            __builder.AddAttribute(48, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 30 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                                        ()=>SortTable("Ball4")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(49, "Ball4");
            __builder.CloseElement();
            __builder.AddMarkupContent(50, "\r\n                    ");
            __builder.OpenElement(51, "span");
            __builder.AddAttribute(52, "class", "fa" + " " + (
#nullable restore
#line 31 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                      GetSortStyle("Ball4")

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseElement();
            __builder.AddMarkupContent(53, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(54, "\r\n                ");
            __builder.OpenElement(55, "th");
            __builder.AddMarkupContent(56, "\r\n                    ");
            __builder.OpenElement(57, "span");
            __builder.AddAttribute(58, "class", "sort-link");
            __builder.AddAttribute(59, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 34 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                                        ()=>SortTable("Ball5")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(60, "Ball5");
            __builder.CloseElement();
            __builder.AddMarkupContent(61, "\r\n                    ");
            __builder.OpenElement(62, "span");
            __builder.AddAttribute(63, "class", "fa" + " " + (
#nullable restore
#line 35 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                      GetSortStyle("Ball5")

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseElement();
            __builder.AddMarkupContent(64, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(65, "\r\n                ");
            __builder.OpenElement(66, "th");
            __builder.AddMarkupContent(67, "\r\n                    ");
            __builder.OpenElement(68, "span");
            __builder.AddAttribute(69, "class", "sort-link");
            __builder.AddAttribute(70, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 38 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                                        ()=>SortTable("Thunderball")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(71, "Thunderball");
            __builder.CloseElement();
            __builder.AddMarkupContent(72, "\r\n                    ");
            __builder.OpenElement(73, "span");
            __builder.AddAttribute(74, "class", "fa" + " " + (
#nullable restore
#line 39 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                      GetSortStyle("Thunderball")

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseElement();
            __builder.AddMarkupContent(75, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(76, "\r\n                ");
            __builder.OpenElement(77, "th");
            __builder.AddMarkupContent(78, "\r\n                    ");
            __builder.OpenElement(79, "span");
            __builder.AddAttribute(80, "class", "sort-link");
            __builder.AddAttribute(81, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 42 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                                        ()=>SortTable("Total")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(82, "Total");
            __builder.CloseElement();
            __builder.AddMarkupContent(83, "\r\n                    ");
            __builder.OpenElement(84, "span");
            __builder.AddAttribute(85, "class", "fa" + " " + (
#nullable restore
#line 43 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
                                      GetSortStyle("Total")

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseElement();
            __builder.AddMarkupContent(86, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(87, "\r\n            ");
            __builder.CloseElement();
            __builder.AddMarkupContent(88, "\r\n        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(89, "\r\n        ");
            __builder.OpenElement(90, "tbody");
            __builder.AddMarkupContent(91, "\r\n");
#nullable restore
#line 48 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
             foreach (var draw in tickets)
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(92, "                ");
            __builder.OpenElement(93, "tr");
            __builder.AddMarkupContent(94, "\r\n                    ");
            __builder.OpenElement(95, "td");
#nullable restore
#line 51 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(96, draw[0]);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(97, "\r\n                    ");
            __builder.OpenElement(98, "td");
#nullable restore
#line 52 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(99, draw[1]);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(100, "\r\n                    ");
            __builder.OpenElement(101, "td");
#nullable restore
#line 53 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(102, draw[2]);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(103, "\r\n                    ");
            __builder.OpenElement(104, "td");
#nullable restore
#line 54 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(105, draw[3]);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(106, "\r\n                    ");
            __builder.OpenElement(107, "td");
#nullable restore
#line 55 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(108, draw[4]);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(109, "\r\n                    ");
            __builder.OpenElement(110, "td");
#nullable restore
#line 56 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(111, draw[5]);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(112, "\r\n                    ");
            __builder.OpenElement(113, "td");
#nullable restore
#line 57 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(114, draw[6]);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(115, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(116, "\r\n");
#nullable restore
#line 59 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
            }

#line default
#line hidden
#nullable disable
            __builder.AddContent(117, "        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(118, "\r\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(119, "\r\n");
#nullable restore
#line 63 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(120, (MarkupString)hotBalls);

#line default
#line hidden
#nullable disable
#nullable restore
#line 64 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(121, (MarkupString)hotBallsLinear);

#line default
#line hidden
#nullable disable
#nullable restore
#line 65 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(122, (MarkupString)deltas);

#line default
#line hidden
#nullable disable
#nullable restore
#line 67 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(123, (MarkupString)drawTotals);

#line default
#line hidden
#nullable disable
            __builder.AddContent(124, "    ");
            __builder.OpenElement(125, "table");
            __builder.AddAttribute(126, "class", "table table-bordered table-hover");
            __builder.AddMarkupContent(127, "\r\n        ");
            __builder.AddMarkupContent(128, "<thead>\r\n            <tr>\r\n                <th>Key</th>\r\n                <th>Value</th>\r\n            </tr>\r\n        </thead>\r\n        ");
            __builder.OpenElement(129, "tbody");
            __builder.AddMarkupContent(130, "\r\n");
#nullable restore
#line 77 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
             foreach (var item in hot)
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(131, "                ");
            __builder.OpenElement(132, "tr");
            __builder.AddMarkupContent(133, "\r\n                    ");
            __builder.OpenElement(134, "td");
#nullable restore
#line 80 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(135, item.Key);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(136, "\r\n                    ");
            __builder.OpenElement(137, "td");
#nullable restore
#line 81 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
__builder.AddContent(138, item.Value);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(139, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(140, "\r\n");
#nullable restore
#line 83 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
            }

#line default
#line hidden
#nullable disable
            __builder.AddContent(141, "        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(142, "\r\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(143, "\r\n");
#nullable restore
#line 86 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"


}

#line default
#line hidden
#nullable disable
        }
        #pragma warning restore 1998
#nullable restore
#line 91 "C:\Users\NEWPORTG\source\Azure\FunctionMonkey\FMLottery\Lottery\Pages\DrawSelection.razor"
 
    List<int[]> tickets = new List<int[]>();
    List<KeyValuePair<int, int>> hot = new List<KeyValuePair<int, int>>();
    IList<ThunderBall> items = new List<ThunderBall>();
    private bool IsSortedAscending;
    private string CurrentSortColumn;
    string hotBalls;
    string hotBallsLinear;
    string drawTotals;
    string deltas;

    protected override async Task OnInitializedAsync()
    {
        items = await ThunderBallService.GetThunderballAsync();

        var ltball = new List<Thunderball>();
        foreach (ThunderBall entity in items)
        {
            // Access the entity properties
            string partitionKey = entity.PartitionKey;
            string rowKey = entity.RowKey;
            // Access other properties of the entity

            ltball.Add(new Thunderball(entity.DrawNumber, entity.Ball1, entity.Ball2, entity.Ball3, entity.Ball4, entity.Ball5, entity.BallSet, entity.DrawDate, entity.Thunderball));
        }

        var td = new ThunderDraws(ltball);

        // Draw selection should be :-
        // 1, Not have consecutive numbers
        // 2, Not have cold numbers
        // 2, Not been drawn before
        // 3, Total should be within the middle of the Total distribution

        tickets = td.GenerateTickets();

        hotBalls = HotBalls(td);
        hotBallsLinear = HotBallsLinear(td);
        drawTotals = DrawTotals(td);
        deltas = Deltas(td);

    }

    public string HotBalls(ThunderDraws td)
    {
        string hotBalls;
        var dic = td.HotBalls();
        hot = dic.OrderBy(x => x.Key).ToList();

        // Whats the lowest hot value
        // Whats the highest hit value
        var val = dic.OrderBy(x => x.Value).ToList();
        var low = val[0].Value;
        var high = val[val.Count - 1].Value;

        hotBalls = "<table class='table-bordered'><tbody>";
        for (int i = 0, j = 0; i < 39 && j < 5; i++, j++)
        {
            if (j == 0)
                hotBalls += "<tr>";

            hotBalls += $"<td bgcolor=#ff{MapNumberToRange(hot[i].Value, low, high, 0, 255)}00>{(hot[i].Key)}</td>";
            if (j == 4)
            {
                hotBalls += "</tr>";
                j = -1;
            }
        }
        hotBalls += "</tr></tbody></table>";

        return hotBalls;
    }

    public string HotBallsLinear(ThunderDraws td)
    {
        string hotBalls;
        var dic = td.HotBalls();
        hot = dic.OrderBy(x => x.Key).ToList();

        // Whats the lowest hot value
        // Whats the highest hit value
        var val = dic.OrderBy(x => x.Value).ToList();
        var low = val[0].Value;
        var high = val[val.Count - 1].Value;

        hotBalls = "<table class='table-bordered'><tbody><tr>";
        foreach( var item in val)
        {
            hotBalls += $"<td bgcolor=#ff{MapNumberToRange(item.Value, low, high, 0, 255)}00>{(item.Key)}</td>";
        }
        hotBalls += "</tr></tbody></table>";

        return hotBalls;
    }

    public string DrawTotals(ThunderDraws td)
    {
        string drawTotals;
        var dic = td.DrawTotals();

        var ord = dic.OrderBy(x => x.Key).ToList();
        var middle = ord.Count() /5 ;

        drawTotals = "<table class='table-bordered'><thead><tr><td>Count</td><td>Totals</td></tr></thead><tbody>";

        foreach (var entry in ord)
        {
            int count = entry.Value;
            int number = entry.Key;
            string distribution = new string('*', count);

            var idx = ord.IndexOf(entry);
            if (idx > middle && idx < middle * 4)
                drawTotals += $"<tr bgcolor=#00ff00><td>{number}</td><td>{distribution}</td></tr>";
            else
                drawTotals += $"<tr><td>{number}</td><td>{distribution}</td></tr>";
        }

        //var groupedEntries = dic.GroupBy(entry => entry.Value).OrderBy(x => x.Key);  // Group the dictionary entries by count
        //foreach (var group in groupedEntries)
        //{
        //    int count = group.Key;
        //    var numbers = group.Select(entry => entry.Key);
        //    string numbersString = string.Join(",", numbers);

        //    drawTotals += $"<tr><td>{count}</td><td>{numbersString}</td></tr>";
        //}

        drawTotals += "</tbody></table>";
        return drawTotals;

    }

    private string MapNumberToRange(int number, int inputMin, int inputMax, int outputMin, int outputMax)
    {
        // Ensure the number is within the input range
        number = Math.Max(inputMin, Math.Min(inputMax, number));

        // Calculate the size of the input and output ranges
        int inputRangeSize = inputMax - inputMin;
        int outputRangeSize = outputMax - outputMin;

        // Calculate the gap ratio between the input and output ranges
        double gapRatio = (double)outputRangeSize / inputRangeSize;

        // Calculate the mapped value
        //byte mappedValue = (byte)((number - inputMin) * gapRatio + outputMin);
        byte mappedValue = (byte)((inputMax - number) * gapRatio + outputMin);

        string hexValue = mappedValue.ToString("X2");

        return hexValue;
    }

    private string GetSortStyle(string columnName)
    {
        if (CurrentSortColumn != columnName)
        {
            return string.Empty;
        }
        if (IsSortedAscending)
        {
            return "fa-sort-up";
        }
        else
        {
            return "fa-sort-down";
        }
    }

    private void SortTable(string columnName)
    {
        //Sorting against a column that is not currently sorted against.
        if (columnName != CurrentSortColumn)
        {
            //We need to force order by ascending on the new column
            //This line uses reflection and will probably perform inefficiently in a production environment.
            items = items.OrderBy(x => x.GetType().GetProperty(columnName).GetValue(x, null)).ToList();
            CurrentSortColumn = columnName;
            IsSortedAscending = true;

        }
        else //Sorting against same column but in different direction
        {
            if (IsSortedAscending)
            {
                items = items.OrderByDescending(x => x.GetType().GetProperty(columnName).GetValue(x, null)).ToList();
            }
            else
            {
                items = items.OrderBy(x => x.GetType().GetProperty(columnName).GetValue(x, null)).ToList();
            }

            //Toggle this boolean
            IsSortedAscending = !IsSortedAscending;
        }
    }

    public string Deltas(ThunderDraws td)
    {
        string deltas;
        var dic = td.Deltas();
        var ord = dic.OrderBy(x => x.Key).ToList();
        var totalcount = 0;
        foreach (var entry in ord)
        {
            totalcount += entry.Value;
        }

        deltas = "<table class='table-bordered'><thead><tr><td>Count</td><td>Percent</td><td>Totals</td></tr></thead><tbody>";


        foreach (var entry in ord)
        {
            int count = entry.Value;
            int number = entry.Key;
            decimal percentage = (decimal)Math.Round((double)(100 * count) / totalcount);

            string distribution = new string('*', count);

            deltas += $"<tr><td>{number}</td><td>{percentage}</td><td>{distribution}</td></tr>";
        }

        deltas += "</tbody></table>";
        return deltas;
    }

    public class ThunderDraws
    {
        int totalNumbers = 39; // Total numbers in the lottery
        int numbersToPick = 5; // Numbers to pick for each ticket
        int ticketsToGenerate = 9; // Number of tickets to generate

        List<Thunderball> previousdraws { get; set; }
        List<int[]> tickets = new List<int[]>();
        Dictionary<int, int> drawtotals = new Dictionary<int, int>();
        Dictionary<int, int> deltas = new Dictionary<int, int>();

        public ThunderDraws(List<Thunderball> draws)
        {
            previousdraws = draws;
        }

        public Dictionary<int, int> HotBalls()
        {
            Dictionary<int, int> hot = new Dictionary<int, int>();

            foreach (var draw in previousdraws)
            {
                foreach (var ball in draw.Balls)
                {
                    if (hot.ContainsKey(ball))
                    {
                        hot[ball]++;
                    }
                    else
                    {
                        hot[ball] = 1;
                    }
                }
            }

            return hot;
        }

        public List<int[]> GenerateTickets()
        {
            List<int[]> tickets = new List<int[]>();

            //var dic = DrawTotals();
            //var ord = dic.OrderBy(x => x.Key).ToList();
            //var dislower = ord.Count() / 5;
            //var dishigher = dislower*4;

            // Generate all possible combinations of numbers
            IEnumerable<IEnumerable<int>> combinations = Enumerable.Range(1, totalNumbers)
                .DifferentCombinations(numbersToPick);

            Random random = new Random();

            // Randomly select tickets from the combinations
            for (int i = 0; i < ticketsToGenerate; i++)
            {
                int[] ticket;
                bool cons;
                bool drawn;
                do
                {
                    ticket = combinations.ElementAt(random.Next(combinations.Count())).ToArray();

                    cons = HasConsecutiveNumbers(ticket);
                    drawn = HasBeenDrawn(ticket);

                    if (cons == true)
                        Console.WriteLine("Rejected - " + string.Join(", ", ticket));
                    if (drawn == true)
                        Console.WriteLine("Previously Drawn - " + string.Join(", ", ticket));

                } while (cons && !drawn);

                // Add ThunderBall
                Random rnd = new Random();
                int[] tic = new int[7];
                for (int j = 0; j < ticket.Length; j++)
                {
                    tic[j] = ticket[j];
                }
                tic[5] = rnd.Next(1, 14);
                tic[6] = tic[0] + tic[1] + tic[2] + tic[3] + tic[4] + tic[5];


                //if (tic[6] > dislower && tic[6] < dishigher)
                //{
                //    tickets.Add(tic);
                //}
                //else
                //{
                //    i--; // lets go round again
                //}

                tickets.Add(tic);
            }

            return tickets;
        }

        private bool HasBeenDrawn(int[] ticket)
        {
            for (int i = 0; i < previousdraws.Count; i++)
            {
                return previousdraws[i].HasBeenDrawn(ticket);
            }
            return false;
        }

        private bool HasConsecutiveNumbers(int[] numbers)
        {
            for (int i = 0; i < numbers.Length - 1; i++)
            {
                if (numbers[i] == numbers[i + 1] - 1)
                {
                    return true;
                }
            }

            return false;
        }

        public Dictionary<int, int> DrawTotals()
        {
            if (drawtotals.Count != 0)
                return drawtotals;

            foreach (var draw in previousdraws)
            {
                if (drawtotals.ContainsKey(draw.DrawTotal()))
                {
                    drawtotals[draw.DrawTotal()]++;
                }
                else
                {
                    drawtotals[draw.DrawTotal()] = 1;
                }
            }
            return drawtotals;
        }

        public Dictionary<int, int> Deltas()
        {
            if (deltas.Count != 0)
                return deltas;

            foreach (var draw in previousdraws)
            {
                foreach (var ball in draw.Delta)
                {
                    if (deltas.ContainsKey(ball))
                    {
                        deltas[ball]++;
                    }
                    else
                    {
                        deltas[ball] = 1;
                    }
                }
            }

            return deltas;
        }
    }

    public class Thunderball
    {
        public Thunderball(string drawNumber, String ball1, String ball2, String ball3, String ball4, String ball5, String ballset, String drawdate, String tball)
        {
            DrawNumber = drawNumber;
            Balls[0] = int.Parse(ball1);
            Balls[1] = int.Parse(ball2);
            Balls[2] = int.Parse(ball3);
            Balls[3] = int.Parse(ball4);
            Balls[4] = int.Parse(ball5);

            SortedBalls = Balls;
            Array.Sort(SortedBalls);
  
            Delta[0] = Balls[1] - Balls[0];
            Delta[1] = Balls[2] - Balls[1];
            Delta[2] = Balls[3] - Balls[2];
            Delta[3] = Balls[4] - Balls[3];

            BallSet = ballset;
            DrawDate = drawdate;
            ThunderBall = int.Parse(tball);
        }

        public string DrawNumber { get; set; }
        public int[] Balls { get; set; } = new int[5];
        public int[] SortedBalls { get; set; } = new int[5];
        public int[] Delta { get; set; } = new int[4];
        public string BallSet { get; set; } = string.Empty;
        public string DrawDate { get; set; } = string.Empty;
        public int ThunderBall { get; set; }

        public int DrawTotal() { return Balls[0] + Balls[1] + Balls[2] + Balls[3] + Balls[4] + ThunderBall; }

        public bool HasBeenDrawn(int[] ticket)
        {
            if (ticket.Contains<int>(Balls[0]) && ticket.Contains<int>(Balls[1]) && ticket.Contains<int>(Balls[2]) && ticket.Contains<int>(Balls[3]) && ticket.Contains<int>(Balls[4]))
            {
                return true;
            }
            return false;
        }

        public string Print()
        {
            return string.Join(", ", Balls);
        }

        public string PrintDelta()
        {
            return string.Join(", ", Delta);
        }

    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IThunderBallService ThunderBallService { get; set; }
    }
}
#pragma warning restore 1591
